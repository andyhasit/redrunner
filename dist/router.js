var t=function(t){return void 0===t};function n(t){var n=document.createElement("template");return n.innerHTML=t,new i(n.content.firstChild)}function e(t,e,r,i){var s=new t(r,e,i);return s.__bv(s,n),s.init(),s.update(),s}var r=function(){function t(t,n,e){this.view=n,this.cls=t,this.cache={},this.keyFn=e||function(t,n){return n},this._seq=0}var n=t.prototype;return n.reset=function(){this._seq=0},n.get=function(t){var n,r=this.keyFn(t,this._seq);return this.cache.hasOwnProperty(r)?n=this.cache[r]:(n=e(this.cls,t,this.view,this._seq),this.cache[r]=n),n.update(t),this._seq+=1,n},t}(),i=function(){function n(t,n){this.e=t,this._c=void 0,this._n=void 0,this.view=n}var e,i=n.prototype;return i.append=function(t){return this._append(t)},i._append=function(t){return this.e.appendChild(t.e)},i.child=function(t){return this.clear(),this._append(t)},i.replace=function(t){this.e.parentNode.replaceChild(t,this.e)},i.clear=function(){return this._n&&(this._n.length=0),this.e.innerHTML="",this.e.textContent="",this.e.value="",this},i.html=function(t){return this.e.innerHTML=t,this},i.inner=function(t){if(!Array.isArray(t))return this.child(t);this._prepRepeat();for(var n=0,e=t.length;n<e;n++)this._append(t[n]);return this._done()},i.items=function(t){var n;this._prepRepeat();for(var e=0,r=t.length;e<r;e++)n=this._c.get(t[e]),this._nest(n),this.e.appendChild(n.root.e);return this._done()},i._nest=function(t){this._n||(this._n=this.view.__nv),this._n.push(t)},i._prepRepeat=function(){this.visible(!1),this.clear()},i._done=function(){return this.visible(!0),this},i.use=function(t){return this._c=new r(t,this),this},i.watch=function(n,e){var r,i,s=this,o=n.split(":");if(1===o.length)r=o[0],i=function(t,n){return e(t,n,s)};else{var u=o[0];r=o[1],i=t(e)?function(t){return s[u](t)}:function(t,n){return s[u](e(t,n,s))}}return this.view.watch(r,i),this},i.css=function(t){return this.e.className=t,this},i.cssAdd=function(t){return this.e.classList.add(t),this},i.cssAddTrans=function(t){var n=this;return this.transition(function(e){return n.e.classList.add(t)})},i.cssRemove=function(t){return this.e.classList.remove(t),this},i.cssRemoveTrans=function(t){var n=this;return this.transition(function(e){return n.e.classList.remove(t)})},i.cssToggle=function(t){return this.e.classList.toggle(t),this},i.att=function(t,n){return this.e.setAttribute(t,n),this},i.atts=function(t){for(var n in t)this.att(n,t[n]);return this},i.checked=function(t){return this.e.checked=t,this},i.href=function(t){return this.att("href",t)},i.id=function(t){return this.att("id",t)},i.src=function(t){return this.att("src",t)},i.value=function(t){return this.att("value",t)},i.text=function(t){return this.e.textContent=t,this},i.on=function(t,n){var e=this;return this.e.addEventListener(t,function(t){return n(t,e)}),this},i.style=function(t,n){return this.e.style[t]=n,this},i.transition=function(t){var n=this;return new Promise(function(e){t(),n.e.addEventListener("transitionend",function t(r){n.e.removeEventListener("transitionend",t),e()})})},i.visible=function(t){return this.style("visibility",t?"visible":"hidden")},(e=[{key:"Value",get:function(){return this.e.value}}])&&function(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(n.prototype,e),n}(),s=function(t){return 1},o=function(t){var n,e;function r(){return t.apply(this,arguments)||this}e=t,(n=r).prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e;var i=r.prototype;return i.init=function(){var t=this,n=this.props,e=n.resources;if(this._routes=n.routes.map(function(t){return new u(t)}),this._resources={},e)for(var r=0,i=Object.entries(e);r<i.length;r++){var s=i[r];this._resources[s[0]]={loaded:!1,func:s[1]}}window.addEventListener("hashchange",function(n){return t._hashChanged()}),window.addEventListener("load",function(n){return t._hashChanged()})},i._resolveResources=function(t){var n=this,e=[];return t&&t.forEach(function(t){var r=n._resources[t];r.loaded||e.push(r.func(n))}),Promise.all(e)},i._hashChanged=function(){var t=location.hash.slice(1)||"/";this._matchRoute(t)},i._matchRoute=function(t){for(var n=this,e=this._routes.length,r=!1,i=function(e){var i=n._routes[e],s=i.match(t);if(s)return r=!0,n._resolveResources(i.resources).then(function(t){i.getView(s).then(function(t){n.root.child(t.root)})}),"break"},s=0;s<e&&"break"!==i(s);s++);if(!r)throw new Error("Route not matched: "+t)},r}(function(){function n(t,n,e){this.__html__="<div/>";var r=this;r.parent=t,r.props=n,r.seq=e,r.__nv=[],r.__ov={},r.root=null,r.dom=null}var r=n.prototype;return r.init=function(){},r.update=function(n){t(n)||(this.props=n),this.__uw(),this.__un()},r.debug=function(){c.log(this.__bv.toString());var t=[];t.push("__wc: {");for(var n=0,e=Object.entries(this.__wc);n<e.length;n++){var r=e[n],i=r[1];t.push('  "'+r[0]+'": ['),i.forEach(function(n){return t.push("  "+n.toString())}),t.push("  ]")}t.push("}"),c.log(t.join("\n"))},r.nest=function(t,n,r){var i=e(t,n,this,r);return this.__nv.push(i),i},r.emit=function(n,e){for(var r=this;!t(r);){var i=r._handlers_;if(n in i)return i[n].apply(r,e);r=r.parent}},r.old=function(t){return this.__ov[t]},r.watch=function(t,n){return this.__wc.hasOwnProperty(t)||(this.__wc[t]=[]),this.__wc[t].push(n),this},r.__gw=function(t){var n=t.reduce(function(t,n){return t.childNodes[n]},this.root.e);return new i(n,this)},r.__un=function(){this.__nv.forEach(function(t){t.__ia()&&t.update()})},r.__uw=function(){var t,n,e,r;for(t in this.__wc){if(n=this.__wq[t].apply(this),e=this.__ov[t],""===t||e!==n)for(var i=0,s=(r=this.__wc[t]).length;i<s;i++)r[i].apply(this,[n,e]);this.__ov[t]=n}},r.__rn=function(t,n){this.__gw(t).replace(n.root.e)},r.__ia=function(){return this.root.e.parentNode},n}()),u=function(){function t(t){this.resources=t.resources;var n,e=t.path;this._vc=new r(t.cls,this,t.keyFn||s);var i=e.split("?");n=i[1],this.chunks=this.buildChunks(e=i[0]),this.params=this.buildParams(n),this.resolve=t.resolve||this.defautResolve}var n=t.prototype;return n.defautResolve=function(t){return Promise.resolve(t)},n.buildChunks=function(t){return t.split("/").map(function(t){return t.startsWith("{")?new h(t.slice(1,-1)):t})},n.buildParams=function(t){var n={};return t&&t.split(",").forEach(function(t){var e=new h(t.trim());n[e.name]=e}),n},n.getView=function(t){var n=this;return this.resolve(t,this).then(function(t){return n._vc.get(t)})},n.match=function(t){var n,e,r=this,i=this.chunks.length,s={},o=t.split("?");n=o[0],e=o.slice(1);var u=n.split("/");if(i!==u.length)return!1;for(var c=function(t){var n=r.chunks[t],e=u[t];if(n instanceof h)s[n.name]=function(t){return n.convert(e)};else if("string"==typeof n&&n!=e)return{v:!1}},a=0;a<i;a++){var f=c(a);if("object"==typeof f)return f.v}for(var v in s)s[v]=s[v]();var l={};return e&&e.join("").split("&").forEach(function(t){var n,e,i=t.split("=");e=i[1],l[n=i[0]]=r.params.hasOwnProperty(n)?r.params[n].convert(e):e}),{args:s,params:l,url:t}},t}(),h=function(){function t(t){var n,e=t.split(":");switch(n=e[1],this.name=e[0],n){case"int":this.conv=function(t){return parseInt(t)};break;case"float":this.conv=function(t){return parseFloat(t)};break;default:this.conv=function(t){return t}}}return t.prototype.convert=function(t){return this.conv(t)},t}();exports.Route=u,exports.RouteArg=h,exports.Router=o;
//# sourceMappingURL=router.js.map
